import{S as W,P as z,H as A,D as H,M as v,W as j,d as y,R as T,e as X,a as S,T as h,f as Y,g as b}from"./three.module.e25001cb.js";import{r as g,B as p,C as k,f as B,_ as F,d as q,o as D,c as E}from"./index.3afbc751.js";const G=()=>{const n=g({lon:0,lat:0});let e=!1,t=0,s=0,o=0,a=0,c=window.innerWidth/2,u=window.innerHeight/2;return p(window,"mousemove",i=>{i.pageX/window.innerWidth*2-1,-(i.pageY/window.innerHeight)*2+1,!(Math.abs(c-i.pageX)+Math.abs(i.pageY-u)<.2)&&e&&(t=(c-i.pageX)*.1+o,s=(i.pageY-u)*.1+a,n.value={lon:t,lat:s})}),p(window,"mousedown",i=>{e=!0,c=i.pageX,u=i.pageY,a=s,o=t}),p(window,"mouseup",()=>{e=!1}),n},I=()=>{const n=g(0),e=g(0);return p(window,"mousemove",t=>{n.value=t.pageX/window.innerWidth*2-1,e.value=-(t.pageY/window.innerHeight)*2+1}),{x:n,y:e}};function O(n,e=50){let t;return function(){clearTimeout(t),t=setTimeout(()=>n(),e)}}function U(n){const e=new X(500,60,60);e.scale(1,1,-1);const t=new S({map:new h().load("/src/assets/images/outside.jpg",n)});return new S({map:new h().load("/src/assets/images/inside_low.jpg")}),new v(e,t)}function N(){const n=new Y({map:new h().load("/src/assets/images/point.png")}),e=new b(n);return e.scale.set(40,40,40),e.position.set(100,0,0),e}function J(n){const e=new W,{innerHeight:t,innerWidth:s}=window,o=new z(75,s/t,1,1e3),a=[],c=new A(16777215);c.position.set(0,40,0);const u=new H(16777215);u.position.set(0,40,-10),e.add(c),e.add(u),e.add(i()),e.add(U(()=>{d()}));function i(){return a.push(N()),a[a.length-1]}function P(){return a}const w=new j;w.setSize(s,t);function f(r=0,m=0,l=0){o.lookAt(500*r,0,500*l),o.updateProjectionMatrix(),requestAnimationFrame(d)}function C(){const{innerHeight:r,innerWidth:m}=window;o.aspect=m/r,w.setSize(m,r),o.updateProjectionMatrix(),d()}function d(){w.render(e,o)}function M(){requestAnimationFrame(d)}function _(){requestAnimationFrame(_),d()}function L(){var r;(r=document.getElementById(n))==null||r.appendChild(w.domElement),f(...x(0,0)),d()}function R(r,m,l){o.position.set(r,m,l),o.updateProjectionMatrix(),M()}return{render:M,loopRender:_,resize:O(C),mount:L,lookAt:f,getRaySprites:P,camera:o,setCameraPosition:R}}function x(n=0,e=0){n=Math.max(-85,Math.min(85,n));const t=y.degToRad(90-n),s=y.degToRad(e),o=Math.sin(t)*Math.cos(s),a=Math.cos(t),c=Math.sin(t)*Math.sin(s);return[o,a,c]}const K=n=>{const e=I(),t=new T;p(window,"mousedown",()=>{t.setFromCamera({x:e.x.value,y:e.y.value},n.camera);const o=t.intersectObjects(n.getRaySprites());if(o.length>0){const{point:a}=o[0];n.setCameraPosition(a.x,a.y,a.z)}})},Q=(n="container")=>{const e=G(),t=J(n);K(t),k(e,({lat:s,lon:o})=>{t.lookAt(...x(s,o))}),p(window,"resize",t.resize),B(()=>{t.mount()})};const V={id:"container",className:"panorama"},Z=q({setup(n){return Q("container"),(e,t)=>(D(),E("div",V))}});var te=F(Z,[["__scopeId","data-v-13353ee1"]]);export{te as default};
